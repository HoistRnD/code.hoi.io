{"version":3,"file":"hoist-min.js","sources":["Hoist.js"],"names":[],"mappings":"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","sourcesContent":["/*jshint loopfunc: true */\n(function () {\n\tvar toString = Object.prototype.toString,\n\t\tsplice = Array.prototype.splice,\n\t\tu;\n\n\t// helpers\n\n\tfunction extend(into, from) {\n\t\tfor (var x in from) into[x] = from[x];\n\t\treturn into;\n\t}\n\n\tfunction get(obj, key, nothing) {\n\t\tif (key.indexOf('.') == -1) {\n\t\t\treturn obj[key];\n\t\t} else {\n\t\t\tkey = key.split('.');\n\n\t\t\tfor (var i = 0; i < key.length - 1; i++) {\n\t\t\t\tobj = obj[key[i]];\n\t\t\t\tif (!obj) return \"\";\n\t\t\t}\n\n\t\t\treturn obj[key[i]];\n\t\t}\n\t}\n\n\tfunction classOf(data) {\n\t\treturn toString.call(data).slice(8, -1);\n\t}\n\n\tfunction asyncError(error, context) {\n\t\tif (typeof error !== \"function\") return;\n\n\t\tvar args = splice.call(arguments, 2);\n\n\t\tsetTimeout(function () {\n\t\t\terror.apply(context, args);\n\t\t}, 0);\n\t}\n\n\t// ajax helper\n\n\tfunction request(configs, opts, success, error, context) {\n\t\tvar method, contentType, responseType;\n\n\t\tif (\"data\" in opts) {\n\t\t\tvar type = classOf(opts.data);\n\n\t\t\tif (type === \"String\") {\n\t\t\t\tcontentType = \"application/json\";\n\t\t\t} else if (type === \"FormData\") {\n\t\t\t\tmethod = opts.method || \"POST\";\n\t\t\t} else {\n\t\t\t\tmethod = opts.method || \"POST\";\n\t\t\t\tcontentType = \"application/json\";\n\t\t\t\topts.data = JSON.stringify(opts.data);\n\t\t\t}\n\t\t} else {\n\t\t\tmethod = opts.method || \"GET\";\n\t\t}\n\n\t\tif (typeof error !== \"function\") {\n\t\t\tif (!context) context = error;\n\t\t\terror = null;\n\t\t}\n\n\t\tif (!configs.apikey) {\n\t\t\treturn asyncError(error, context, \"API key not set\", null);\n\t\t}\n\n\t\tvar xhr = new XMLHttpRequest();\n\n\t\txhr.open(method, configs.protocol + opts.url);\n\n\t\tresponseType = opts.responseType || \"json\";\n\n\t\t// Safari will error out (!) if we try to set a responseType of \"json\"\n\n\t\tif (responseType != \"json\") {\n\t\t\txhr.responseType = responseType;\n\n\t\t\t// Safari before 6.1 does not support \"blob\" but does support \"arraybuffer\"\n\n\t\t\tif (responseType == \"blob\" && xhr.responseType != \"blob\") {\n\t\t\t\txhr.responseType = \"arraybuffer\";\n\t\t\t}\n\t\t}\n\n\t\tcontentType && xhr.setRequestHeader(\"Content-Type\", contentType);\n\n\t\txhr.setRequestHeader(\"Authorization\", \"Hoist \" + configs.apikey);\n\n\t\txhr.withCredentials = true;\n\n\t\txhr.onreadystatechange = function () {\n\t\t\tif (xhr.readyState === 4) {\n\t\t\t\tif (xhr.status >= 200 && xhr.status < 400) {\n\t\t\t\t\tvar response = xhr.response || xhr.responseText,\n\t\t\t\t\t\ttype = classOf(response);\n\n\t\t\t\t\tif (type === \"String\" && responseType === \"json\") {\n\t\t\t\t\t\tresponse = JSON.parse(response);\n\t\t\t\t\t} else if (type === \"ArrayBuffer\" && responseType === \"blob\") {\n\t\t\t\t\t\tresponse = new Blob([response]);\n\t\t\t\t\t}\n\n\t\t\t\t\tsuccess && success.call(context, response, xhr);\n\t\t\t\t} else {\n\t\t\t\t\terror && error.call(context, xhr.statusText, xhr);\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\n\t\txhr.send(opts.data);\n\t}\n\n\t// simple data manager\n\n\tfunction DataManager(hoist, type) {\n\t\tthis.type = type;\n\t\tthis.url = \"data.hoi.io/\" + type;\n\t\tthis.hoist = hoist;\n\t}\n\n\textend(DataManager.prototype, {\n\t\tget: function (id, success, error, context) {\n\t\t\tif (typeof id === \"function\") {\n\t\t\t\tcontext = error;\n\t\t\t\terror = success;\n\t\t\t\tsuccess = id;\n\t\t\t\tid = null;\n\t\t\t}\n\n\t\t\tif (id) {\n\t\t\t\trequest(this.hoist._configs, { url: this.url + \"/\" + id }, success, error, context);\n\t\t\t} else {\n\t\t\t\trequest(this.hoist._configs, { url: this.url }, success, error, context);\n\t\t\t}\n\t\t},\n\n\t\tpost: function (id, data, success, error, context) {\n\t\t\tif (typeof id === \"object\" && id !== null) {\n\t\t\t\tcontext = error;\n\t\t\t\terror = success;\n\t\t\t\tsuccess = data;\n\t\t\t\tdata = id;\n\t\t\t\tid = data._id;\n\t\t\t}\n\n\t\t\tvar singleton = classOf(data) === \"Array\" && data.length === 1;\n\n\t\t\tif (id) {\n\t\t\t\trequest(this.hoist._configs, { url: this.url + \"/\" + id, data: data }, success, error, context);\n\t\t\t} else {\n\t\t\t\trequest(this.hoist._configs, { url: this.url, data: data }, success && function (resp, xhr) {\n\t\t\t\t\tsuccess.call(this, singleton ? [resp] : resp, xhr);\n\t\t\t\t}, error, context);\n\t\t\t}\n\t\t},\n\n\t\tclear: function (success, error, context) {\n\t\t\trequest(this.hoist._configs, { url: this.url, method: \"DELETE\" }, success, error, context);\n\t\t},\n\n\t\tremove: function (id, success, error, context) {\n\t\t\tif (!id) {\n\t\t\t\treturn asyncError(error, context, \"Cannot remove model with empty id\", null);\n\t\t\t}\n\n\t\t\trequest(this.hoist._configs, { url: this.url + \"/\" + id, method: \"DELETE\" }, success, error, context);\n\t\t}\n\t});\n\n\t// complex data manager\n\n\tvar tagRegex = /\\[([^\\]]+)\\]/g;\n\n\tfunction ObjectDataManager(hoist, hash) {\n\t\tvar items = this.items = {};\n\n\t\tfor (var x in hash) {\n\t\t\tvar item = { key: x, path: hash[x], requires: [] },\n\t\t\t\tmatch;\n\n\t\t\tif (item.path[item.path.length - 1] == '?') {\n\t\t\t\titem.path = item.path.slice(0, -1);\n\t\t\t\titem.optional = true;\n\t\t\t}\n\n\t\t\twhile ((match = tagRegex.exec(item.path)) !== null) {\n\t\t\t\tvar dot = match[1].indexOf('.');\n\n\t\t\t\tif (dot > -1) {\n\t\t\t\t\titem.requires.push(match[1].slice(0, dot));\n\t\t\t\t}\n\t\t\t}\n\n\t\t\titems[x] = item;\n\t\t}\n\n\t\tthis.hoist = hoist;\n\t}\n\n\textend(ObjectDataManager.prototype, {\n\t\tget: function (data, success, error, context) {\n\t\t\tvar items = {},\n\t\t\t\tresult = {},\n\t\t\t\tmanagers = {},\n\t\t\t\thoist = this.hoist,\n\t\t\t\tfailed;\n\n\t\t\tif (typeof data === \"function\") {\n\t\t\t\tcontext = error;\n\t\t\t\terror = success;\n\t\t\t\tsuccess = data;\n\t\t\t\tdata = {};\n\t\t\t} else if (typeof data === \"string\") {\n\t\t\t\tdata = { id: data };\n\t\t\t}\n\n\t\t\textend(items, this.items);\n\n\t\t\tif (typeof error !== \"function\") {\n\t\t\t\tif (!context) context = error;\n\t\t\t\terror = null;\n\t\t\t}\n\n\t\t\tfunction succeed(key) {\n\t\t\t\treturn function (data) {\n\t\t\t\t\tresult[key] = data;\n\t\t\t\t\tdelete items[key];\n\t\t\t\t\tadvance();\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tfunction fail(key) {\n\t\t\t\treturn function (msg, xhr) {\n\t\t\t\t\tif (items[key].optional) {\n\t\t\t\t\t\tsucceed(key)(null);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfailed = true;\n\t\t\t\t\t\terror && error.call(context, key + \": \" + msg, xhr);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\n\t\t\tfunction advance() {\n\t\t\t\tif (failed) return;\n\n\t\t\t\tvar loading = 0;\n\n\t\t\t\tout: for (var x in items) {\n\t\t\t\t\tvar item = items[x];\n\n\t\t\t\t\tif (!managers[x]) {\n\t\t\t\t\t\tfor (var i = 0; i < item.requires.length; i++) {\n\t\t\t\t\t\t\tif (item.requires[i] in items) {\n\t\t\t\t\t\t\t\tcontinue out;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tvar path = item.path.replace(tagRegex, function (a, b) {\n\t\t\t\t\t\t\t\tif (b.indexOf('.') > -1) {\n\t\t\t\t\t\t\t\t\treturn get(result, b);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\treturn data[b] || \"\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}),\n\t\t\t\t\t\t\tspace = path.indexOf(' ');\n\n\t\t\t\t\t\tif (space > -1) {\n\t\t\t\t\t\t\t(managers[item.key] = hoist(path.slice(0, space))).get(path.slice(space + 1), succeed(item.key), fail(item.key));\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t(managers[item.key] = hoist(path)).get(succeed(item.key), fail(item.key));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tloading++;\n\t\t\t\t}\n\n\t\t\t\tif (!loading) success.call(context, result, managers);\n\t\t\t}\n\n\t\t\tadvance();\n\t\t}\n\t});\n\n\tvar hoistMethods = {\n\t\tapiKey: function (v) {\n\t\t\treturn this.config(\"apikey\", v);\n\t\t},\n\n\t\tget: function (type, id, success, error, context) {\n\t\t\tthis(type).get(id, success, error, context);\n\t\t},\n\n\t\tpost: function (type, id, data, success, error, context) {\n\t\t\tthis(type).post(id, data, success, error, context);\n\t\t},\n\n\t\tclear: function (type, success, error, context) {\n\t\t\tthis(type).clear(success, error, context);\n\t\t},\n\n\t\tremove: function (type, id, success, error, context) {\n\t\t\tthis(type).remove(id, success, error, context);\n\t\t},\n\n\t\tconfig: function (a, b) {\n\t\t\tif (b === u) {\n\t\t\t\tvar type = typeof a;\n\n\t\t\t\tif (type === \"string\") {\n\t\t\t\t\treturn this._configs[a];\n\t\t\t\t} else if (type === \"object\") {\n\t\t\t\t\tfor (var x in a) {\n\t\t\t\t\t\tthis._configs[x.toLowerCase()] = a[x];\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._configs[a.toLowerCase()] = b;\n\t\t\t}\n\t\t},\n\n\t\tstatus: function (success, error, context) {\n\t\t\tvar hoist = this;\n\n\t\t\tif (typeof error !== \"function\") {\n\t\t\tif (!context) context = error;\n\t\t\t\terror = null;\n\t\t\t}\n\n\t\t\trequest(this._configs, { url: \"auth.hoi.io/status\" }, function (resp) {\n\t\t\t\thoist._user = resp;\n\t\t\t\tsuccess && success.apply(this, arguments);\n\t\t\t}, function () {\n\t\t\t\thoist._user = null;\n\t\t\t\terror && error.apply(this, arguments);\n\t\t\t}, context);\n\t\t},\n\n\t\tsignup: function (member, success, error, context) {\n\t\t\tvar hoist = this;\n\n\t\t\tif (typeof member === \"object\") {\n\t\t\t\trequest(this._configs, { url: \"auth.hoi.io/user\", data: member }, function (resp) {\n\t\t\t\t\thoist._user = resp;\n\t\t\t\t\tsuccess && success.apply(this, arguments);\n\t\t\t\t}, error, context);\n\t\t\t}\n\t\t},\n\n\t\tlogin: function (member, success, error, context) {\n\t\t\tvar hoist = this;\n\n\t\t\tif (typeof member === \"object\") {\n\t\t\t\trequest(this._configs, { url: \"auth.hoi.io/login\", data: member }, function (resp) {\n\t\t\t\t\thoist._user = resp;\n\t\t\t\t\tsuccess && success.apply(this, arguments);\n\t\t\t\t}, error, context);\n\t\t\t}\n\t\t},\n\n\t\tlogout: function (success, error, context) {\n\t\t\tvar hoist = this;\n\n\t\t\trequest(this._configs, { url: \"auth.hoi.io/logout\", method: \"POST\" }, function () {\n\t\t\t\thoist._user = null;\n\t\t\t\tsuccess && success.apply(this, arguments);\n\t\t\t}, error, context);\n\t\t},\n\n\t\tuser: function () {\n\t\t\treturn this._user && extend({}, this._user);\n\t\t},\n\n\t\tnotify: function (id, data, success, error, context) {\n\t\t\tif (typeof id === \"object\") {\n\t\t\t\tcontext = error;\n\t\t\t\terror = success;\n\t\t\t\tsuccess = data;\n\t\t\t\tdata = id.data;\n\t\t\t\tid = id.id;\n\t\t\t}\n\n\t\t\tif (typeof data === \"object\") {\n\t\t\t\trequest(this._configs, { url: \"notify.hoi.io/notification/\" + id, data: data }, success, error, context);\n\t\t\t}\n\t\t},\n\n\t\tfile: function (key, file, success, error, context) {\n\t\t\tif (file.jquery) file = file[0];\n\n\t\t\tvar type = classOf(file),\n\t\t\t\tdata;\n\n\t\t\tif (type === \"File\") {\n\t\t\t\tdata = new FormData();\n\t\t\t\tdata.append(\"file\", file);\n\t\t\t} else if (type === \"FormData\") {\n\t\t\t\tdata = file;\n\t\t\t} else if (type === \"HTMLInputElement\") {\n\t\t\t\tfile = file.files && file.files[0];\n\n\t\t\t\tif (!file) return false;\n\n\t\t\t\tdata = new FormData();\n\t\t\t\tdata.append(\"file\", file);\n\t\t\t} else if (type === \"Function\") {\n\t\t\t\tcontext = error;\n\t\t\t\terror = success;\n\t\t\t\tsuccess = file;\n\n\t\t\t\trequest(this._configs, { url: \"file.hoi.io/\" + key, responseType: \"blob\" }, success, error, context);\n\t\t\t\treturn;\n\t\t\t} else if (type === \"Undefined\") {\n\t\t\t\trequest(this._configs, { url: \"file.hoi.io/\" + key, responseType: \"blob\" }, success, error, context);\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\trequest(this._configs, { url: \"file.hoi.io/\" + key, data: data }, success, error, context);\n\t\t},\n\n\t\tclone: function () {\n\t\t\tvar hoist = extend(makeHoist(), {\n\t\t\t\t_configs: extend({}, this._configs),\n\t\t\t\t_user: null,\n\t\t\t\t_bucket: null,\n\t\t\t\t_managers: {}\n\t\t\t});\n\n\t\t\treturn hoist;\n\t\t}\n\t};\n\n\tvar bucketMethods = {\n\t\tstatus: function (success, error, context) {\n\t\t\tvar hoist = this._hoist;\n\n\t\t\tif (typeof error !== \"function\") {\n\t\t\t\tif (!context) context = error;\n\t\t\t\terror = null;\n\t\t\t}\n\n\t\t\trequest(this._hoist._configs, { url: \"auth.hoi.io/bucket/current\" }, function (bucket) {\n\t\t\t\thoist._bucket = bucket;\n\t\t\t\tsuccess && success.apply(this, arguments);\n\t\t\t}, function () {\n\t\t\t\thoist._bucket = null;\n\t\t\t\terror && error.apply(this, arguments);\n\t\t\t}, context);\n\t\t},\n\n\t\tpost: function (id, data, success, error, context) {\n\t\t\tif (typeof data !== \"object\") {\n\t\t\t\tcontext = error;\n\t\t\t\terror = success;\n\t\t\t\tsuccess = data;\n\t\t\t\tdata = null;\n\t\t\t}\n\n\t\t\trequest(this._hoist._configs, { url: \"auth.hoi.io/bucket/\" + id, data: data }, success, error, context);\n\t\t},\n\n\t\tmeta: function (key, meta, success, error, context) {\n\t\t\tvar hoist = this._hoist;\n\n\t\t\tif (typeof key !== \"string\") {\n\t\t\t\tcontext = error;\n\t\t\t\terror = success;\n\t\t\t\tsuccess = meta;\n\t\t\t\tmeta = key;\n\n\t\t\t\tif (!hoist._bucket) {\n\t\t\t\t\treturn asyncError(error, context, \"No bucket to post metadata against\", null);\n\t\t\t\t}\n\n\t\t\t\tkey = hoist._bucket.key;\n\n\t\t\t\trequest(hoist._configs, { url: \"auth.hoi.io/bucket/\" + key + \"/meta\", data: meta }, function (bucket) {\n\t\t\t\t\thoist._bucket = bucket;\n\t\t\t\t\tsuccess && success.apply(this, arguments);\n\t\t\t\t}, error, context);\n\t\t\t} else {\n\t\t\t\trequest(hoist._configs, { url: \"auth.hoi.io/bucket/\" + key + \"/meta\", data: meta }, success, error, context);\n\t\t\t}\n\t\t},\n\n\t\tset: function (key, success, error, context) {\n\t\t\tvar hoist = this._hoist;\n\n\t\t\trequest(this._hoist._configs, { url: \"auth.hoi.io/bucket/current/\" + (key || \"default\"), method: \"POST\" }, function (bucket) {\n\t\t\t\thoist._bucket = key ? bucket : null;\n\t\t\t\tsuccess && success.apply(this, arguments);\n\t\t\t}, error, context);\n\t\t},\n\n\t\tlist: function (success, error, context) {\n\t\t\trequest(this._hoist._configs, { url: \"auth.hoi.io/buckets\" }, success, error, context);\n\t\t},\n\n\t\tinvite: function (data, success, error, context) {\n\t\t\trequest(this._hoist._configs, { url: \"auth.hoi.io/invite\", data: data }, success, error, context);\n\t\t}\n\t};\n\n\tfunction makeHoist() {\n\t\tvar hoist = extend(function (type) {\n\t\t\tif (classOf(type) === \"Object\") {\n\t\t\t\treturn new ObjectDataManager(hoist, type);\n\t\t\t} else {\n\t\t\t\treturn hoist._managers[type] || (hoist._managers[type] = new DataManager(hoist, type));\n\t\t\t}\n\t\t}, hoistMethods);\n\n\t\thoist.bucket = extend(function (meta, success, error, context, cx) {\n\t\t\tvar type = typeof meta;\n\n\t\t\tif (type === \"function\") {\n\t\t\t\thoist.bucket.status(meta, success, error);\n\t\t\t} else if (type === \"string\" && typeof success === \"object\") {\n\t\t\t\t\thoist.bucket.post(meta, success, error, context, cx);\n\t\t\t} else if (type === \"string\" || meta === null) {\n\t\t\t\thoist.bucket.set(meta, success, error, context);\n\t\t\t} else if (type === \"object\") {\n\t\t\t\thoist.bucket.meta(meta, success, error, context);\n\t\t\t} else {\n\t\t\t\treturn hoist._bucket;\n\t\t\t}\n\t\t}, bucketMethods);\n\n\t\thoist.bucket._hoist = hoist;\n\n\t\treturn hoist;\n\t}\n\n\tvar Hoist = extend(makeHoist(), {\n\t\t_configs: {\n\t\t\tprotocol: \"https://\"\n\t\t},\n\t\t_user: null,\n\t\t_bucket: null,\n\t\t_managers: {}\n\t});\n\n\t// throw Hoist at something it will stick to\n\n\tif (typeof define === \"function\" && define.amd) {\n\t\tdefine(\"Hoist\", [], function () { return Hoist; });\n\t}\n\telse if (typeof window === \"object\" && typeof window.document === \"object\") {\n\t\twindow.Hoist = Hoist;\n\t}\n\telse if (typeof module === \"object\" && typeof module.exports === \"object\") {\n\t\tmodule.exports = Hoist;\n\t}\n})();\n\n"]}