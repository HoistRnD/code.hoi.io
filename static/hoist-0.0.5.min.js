
!function(){var t=function(){function e(t,e){for(var n in e)t[n]=e[n]}function n(t,e){if(-1==e.indexOf("."))return t[e];e=e.split(".");for(var n=0;n<e.length-1;n++)if(t=t[e[n]],!t)return"";return t[e[n]]}function i(t){return c.call(t).slice(8,-1)}function o(t,e){if("function"==typeof t){var n=p.call(arguments,2);setTimeout(function(){t.apply(e,n)},0)}}function r(t,e,n,r){var u,a,f;if("data"in t){var l=i(t.data);"String"===l?a="application/json":"FormData"===l?u="POST":(u="POST",a="application/json",t.data=JSON.stringify(t.data))}else u=t.method||"GET";if("function"!=typeof n&&(r||(r=n),n=null),!s.apikey)return o(n,r,"API key not set",null);var c=new XMLHttpRequest;c.open(u,s.protocol+t.url),f=t.responseType||"json","json"!=f&&(c.responseType=f,"blob"==f&&"blob"!=c.responseType&&(c.responseType="arraybuffer")),a&&c.setRequestHeader("Content-Type",a),c.setRequestHeader("Authorization","Hoist "+s.apikey),c.withCredentials=!0,c.onreadystatechange=function(){if(4===c.readyState)if(c.status>=200&&c.status<400){var t=c.response||c.responseText,o=i(t);"String"===o&&"json"===f?t=JSON.parse(t):"ArrayBuffer"===o&&"blob"===f&&(t=new Blob([t])),e&&e.call(r,t,c)}else n&&n.call(r,c.statusText,c)},c.send(t.data)}function u(t){this.type=t,this.url="data.hoi.io/"+t}function a(t){var e=this.items={};for(var n in t){var i,o={key:n,path:t[n],requires:[]};for("?"==o.path[o.path.length-1]&&(o.path=o.path.slice(0,-1),o.optional=!0);null!==(i=d.exec(o.path));){var r=i[1].indexOf(".");r>-1&&o.requires.push(i[1].slice(0,r))}e[n]=o}}var f,l,s={protocol:"https://"},c=Object.prototype.toString,p=Array.prototype.splice,y={};e(u.prototype,{get:function(t,e,n,i){"function"==typeof t||void 0===t?(i=n,n=e,e=t,r({url:this.url},e,n,i)):r({url:this.url+"/"+t},e,n,i)},post:function(t,e,n,o,u){if("object"==typeof t){var a="Array"===i(t);if(u=o,o=n,n=e,e=t,!e._id)return r({url:this.url,data:e},n&&function(t,e){n.call(this,a?t:t[0],e)},o,u),void 0;t=e._id}r({url:this.url+"/"+t,data:e},n,o,u)},clear:function(t,e,n){r({url:this.url,method:"DELETE"},t,e,n)},remove:function(t,e,n,i){return t?(r({url:this.url+"/"+t,method:"DELETE"},e,n,i),void 0):o(n,i,"Cannot remove model with empty id",null)}});var d=/\[([^\]]+)\]/g;return e(a.prototype,{get:function(i,o,r,u){function a(t){return function(e){p[t]=e,delete c[t],l()}}function f(t){return function(e,n){c[t].optional?a(t)(null):(s=!0,r&&r.call(u,t+": "+e,n))}}function l(){if(!s){var e=0;t:for(var r in c){var l=c[r];if(!y[r]){for(var h=0;h<l.requires.length;h++)if(l.requires[h]in c)continue t;var v=l.path.replace(d,function(t,e){return e.indexOf(".")>-1?n(p,e):i[e]||""}),g=v.indexOf(" ");g>-1?(y[l.key]=t(v.slice(0,g))).get(v.slice(g+1),a(l.key),f(l.key)):(y[l.key]=t(v)).get(a(l.key),f(l.key))}e++}e||o.call(u,p,y)}}var s,c={},p={},y={};"function"==typeof i?(u=r,r=o,o=i,i={}):"string"==typeof i&&(i={id:i}),e(c,this.items),"function"!=typeof r&&(u||(u=r),r=null),l()}}),t=function(t){return"Object"===i(t)?new a(t):y[t]||(y[t]=new u(t))},e(t,{apiKey:function(t){return this.config("apikey",t)},get:function(e,n,i,o,r){t(e).get(n,i,o,r)},post:function(e,n,i,o,r,u){t(e).post(n,i,o,r,u)},clear:function(e,n,i,o){t(e).clear(n,i,o)},remove:function(e,n,i,o,r){t(e).remove(n,i,o,r)},config:function(t,e){if(e===l){var n=typeof t;if("string"===n)return s[t];if("object"===n)for(var i in t)s[i.toLowerCase()]=t[i]}else s[t.toLowerCase()]=e},status:function(t,e,n){r({url:"auth.hoi.io/status"},function(e){f=e,t&&t.apply(this,arguments)},e,n)},signup:function(t,e,n,i){"object"==typeof t&&r({url:"auth.hoi.io/user",data:t},function(t){f=t,e&&e.apply(this,arguments)},n,i)},login:function(t,e,n,i){"object"==typeof t&&r({url:"auth.hoi.io/login",data:t},function(t){f=t,e&&e.apply(this,arguments)},n,i)},logout:function(t,e,n){r({url:"auth.hoi.io/logout",method:"POST"},t,e,n)},user:function(){return f},notify:function(t,e,n,i,o){"object"==typeof t&&(o=i,i=n,n=e,e=t.data,t=t.id),"object"==typeof e&&r({url:"notify.hoi.io/notification/"+t,data:e},n,i,o)},file:function(t,e,n,o,u){e.jQuery&&(e=e[0]);var a,f=i(e);if("File"===f)a=new FormData,a.append("file",e);else if("FormData"===f)a=e;else{if("HTMLInputElement"!==f)return"Function"===f?(u=o,o=n,n=e,r({url:"file.hoi.io/"+t,responseType:"blob"},n,o,u),void 0):"Undefined"===f?(r({url:"file.hoi.io/"+t,responseType:"blob"},n,o,u),void 0):void 0;if(e=e.files&&e.files[0],!e)return!1;a=new FormData,a.append("file",e)}r({url:"file.hoi.io/"+t,data:a},n,o,u)}}),t.clone=arguments.callee,t}();"function"==typeof define&&define.amd?define("Hoist",[],function(){return t}):window.Hoist=t}();
//# sourceMappingURL=hoist-0.0.5.min.js.map